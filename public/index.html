<html>
  <head>
    <meta charset="utf-8">

    <script src="https://www.gstatic.com/firebasejs/5.0.4/firebase.js"></script>
    <script>
      var config = {
        apiKey: "AIzaSyBU8v6yKoZtM_v6JWrie3qgy4RoCEkVL_w",
        authDomain: "yemima-1526762841404.firebaseapp.com",
        databaseURL: "https://yemima-1526762841404.firebaseio.com",
        projectId: "yemima-1526762841404",
        storageBucket: "",
        messagingSenderId: "846714530381"
      };
      firebase.initializeApp(config);
    </script>

    <script
      src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
      integrity="sha256-3edrmyuQ0w65f8gfBsqowzjJe2iM6n0nKciPUp8y+7E="
      crossorigin="anonymous">
    </script>

    <script src="https://unpkg.com/current-device/umd/current-device.min.js"></script>

    <script>
      var commonPrice = {
        distance: 150
      }
      var alg = {
        "10": Object.assign({}, commonPrice, {
          dj: {
            withoutWorkshop: 500
          },
          design: 450,
          massage: 650,
          sweets: 600,
          workshop: 1100,
          bar: {
            min: 1000,
            max: 1400
          },
          photo: {
            withoutWorkshop: 500
          }
        }),
          
        "20": Object.assign({}, commonPrice, {
          dj: {
            withoutWorkshop: 800
          },
          design: 700,
          massage: 900,
          sweets: 800,
          workshop: 1500,
          bar: {
            min: 1300,
            max: 2300
          },
          photo: {
            withoutWorkshop: 700
          }
        }),

        "40": Object.assign({}, commonPrice, {
          dj: {
            withoutWorkshop: 1000
          },
          design: {
            min: 900,
            max: 1200
          },
          massage: {
            min: 1000,
            max: 1400
          },
          sweets: {
            min: 1000,
            max: 1500
          },
          workshop: {
            min: 1600,
            max: 2800
          },
          bar: {
            min: 2500,
            max: 4000
          },
          photo: {
            withoutWorkshop: {
              min: 900,
              max: 1500
            }
          }
        })
      }
    </script>

    <script>
      $(function () {
        $('.people').click(function (e) {
          selectPeopleCount(this)
        })

        selectPeopleCount('.people:nth-child(2)')

        function selectPeopleCount (el) {
          $('.people').removeClass('people-active')
          $(el).toggleClass('people-active')
          setPrices()
        }

        $('.category').click(function (e) {
          $this = $(this)
          e.stopPropagation()
          $this.toggleClass('selected')
          setPrices()

          if ($this.data('type') == 'workshop') {
            var isSelected = $this.hasClass('selected')
            $('[data-type="dj"], [data-type="photo"]').toggleClass('price-included', isSelected)
          }
        })

        function setPrices () {
          var peopleCount = $('.people-active').data('value')
          var prices = alg[peopleCount]
          var totalPrice = { min: 0, max: 0 }

          Object.keys(prices).forEach(function (type) {
            var currentPrice = prices[type]
            var price = getPrice(currentPrice)
            setTypePrice(type, price)

            if (isPriceSelected(type)) {
              if (price.min) {
                totalPrice.min += price.min
                totalPrice.max += price.max
              }
              else {
                totalPrice.min += price
                totalPrice.max += price
              }
            }
          })

          if (totalPrice.min == totalPrice.max)
            $('.total-price .price').text(totalPrice.min + '₪')
          else
            $('.total-price .price').text(totalPrice.min + '₪' + '-' + totalPrice.max + '₪')
        }

        function setTypePrice (type, price) {
          var $price = $('.category[data-type="'+type+'"] .price')

          $price.text(formatPrice(price))
        }


        function formatPrice (price) {
          if (price.min)
            return 'כ-' + (price.min + (price.max - price.min) / 2) + '₪'
          else
            return price + '₪'
        }

        function getPrice (price) {
          var result

          if (price.withoutWorkshop) {
            if (isWorkshopSelected())
              result = 0
            else
              result = price.withoutWorkshop
          }
          else
            result = price

          return result
        }

        function isWorkshopSelected () {
          return isPriceSelected('workshop')
        }

        function isPriceSelected (type) {
          return $('.selected[data-type="'+type+'"]').length
        }
      })
    </script>

    <link rel="stylesheet" type="text/css" href="https://unpkg.com/normalize.css@8.0.0/normalize.css">

    <style>
      html {
        font-weight: 300;
        font-size: 30px;
        color: #f2bbba;
      }
      @media only screen and (orientation: landscape) {
        html {
          font-size: 16px;
        }
      }

      p {
        margin: 0;
      }
      h1, h2, h3, h4, h5, h6 {
        font-weight: 400;
      }
      * {
        -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
        -moz-tap-highlight-color: rgba(0, 0, 0, 0);
      }

      .logo {
        position: absolute;
        top: 50px;
        left: 30px;
        width: 250px;
        height: 250px;

        background-color: #f78f8f;
        border: 1px solid #fff;
        border-radius: 50%;
        box-shadow: 0 0 0 3px #f78f8f;

        background-image: url('./yemima-big-t.png');
        background-size: 70% 70%;
        background-position: center;
        background-repeat: no-repeat;
      }

      .fixed-to-center {
        position: fixed;
        width: 960px;
        left: 50%;
        transform: translateX(-50%);
        z-index: 2;

        text-align: center;
      }

      body > header {
        top: 0;

        padding: 10px 0;
        background: #fff;
      }

      .call-us, .whatsapp {
        position: absolute;
        right: 50px;
        padding: 25px;

        background-color: #E45954;
        border-radius: 50%;
      }
      .call-us {
        top: 50px;
      }
      .whatsapp {
        display: none;
      }
      .mobile .whatsapp {
        display: block;
        top: 250px;
      }

      body > footer {
        bottom: 0;
      }

      main {
        position: relative;
        top: 0;
        padding: 420px 2rem 7rem 2rem;

        width: 960px;
        margin-left: auto;
        margin-right: auto;
      }

      main > section {
        margin-top: 2rem;
      }
      #nav-toggle {
        position: absolute;
        bottom: 20px;
        right: 40px;
        cursor: pointer;
        z-index: 3;

        border: solid black;
        border-width: 0 11px 11px 0;
        display: inline-block;
        padding: 17px;
        transform: rotate(-45deg);
      }

      @media only screen and (orientation: landscape) {
      }

      .nav-closed #nav-toggle {
        transform: rotate(135deg);
        margin-right: -13px;
      }
      .nav-closed #main-text {
        right: calc(50% - 355px);
        width: 825px;
        transition: all 1s .3s;
      }
      .nav-closed nav > div {
        width: 60px;
        height: 60px;
        transition: all 1s .3s;
      }
      .nav-closed nav > div > *:not(img) {
        opacity: 0;
        width: 0;
        transition: all .3s;
      }

      nav > div {
        padding: 10px;
        border: 1px solid transparent;
        border-width: 0 1px;
        min-width: 60px;
        position: relative;
        min-height: 43px;
      }
      nav > div + div {
        margin-top: 20px;
      }

      main > nav > div.type-active {
        background: #fff6e5;
      }

      nav > div select,
    </style>

    <style>
      .people {
        position: relative;

        display: inline-block;
        font-size: 2rem;
        height: 4.5rem;
        width: 4.5rem;
        text-align: center;

        color: #000;
        border: 5px solid #DFDFDF;
        border-radius: 50%;
      }
      .people + .people {
        margin-right: 1.5rem;
      }
      .people::after {
        content: attr(data-value);
        display: inline-block;
        position: absolute;
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
      }

      .people-active {
        background-color: #EA9492;
        color: #fff;
      }
    </style>
  </head>
  <body dir="rtl">
    <header class="fixed-to-center">
      <img src="./maya-big.jpg" width="600px">
      <span class="logo"></span>
      <a class="call-us" href="tel:+972526827666" rel="nofollow">
        <img src="./phone.jpg" width="100px">
      </a>
      <a class="whatsapp" href="https://api.whatsapp.com/send?phone=+972526827666" rel="nofollow">
        <img src="./whatsapp.png" width="100px">
      </a>
    </header>

    <main>
      <section>
        <h2>מספר אנשים</h2>
        <div>
          <span class="people" data-value="10"></span>
          <span class="people" data-value="20"></span>
          <span class="people" data-value="40"></span>
          <span class="people" data-value="70"></span>
          <span class="people" data-value="100"></span>
        </div>
      </section>

      <style>
        .category {
          position: relative;
          display: inline-block;
          width: 450px;
          overflow: hidden;
          margin-top: 30px;
        }
        .category:nth-of-type(2n) {
          margin-right: calc(60px - 8px);
        }
        .category:hover {
          cursor: pointer;
        }
        .category h2 {
          margin: .5rem 0;
        }
        .category::after {
          content: '';
          position: absolute;
          top: 3rem;
          right: 0;
          bottom: 0;
          left: 0;
          border: 5px solid transparent;
        }
        .category.selected::after {
          border-color: #EA9492;
        }
        .category h2 {
          text-align: center;
          box-sizing: border-box;
          height: 2rem;
        }
        .category .price {
          position: absolute;
          width: 100%;
          bottom: 0;
          right: 0;

          background-color: rgba(255, 255, 255, 0.8);
          color: #000;

          text-align: center;
          font-size: 1.5rem;
          line-height: 3rem;
        }

        .category.selected .price {
          background-color: #EA9492;
          color: #FDF5F5;
        }
      </style>
      <section>
        <div class="category" data-type="distance">
          <h2>
            100 ק״מ מת״א
          </h2>
          <img src="https://maps.googleapis.com/maps/api/staticmap?size=450x350&path=color:0x00000000|weight:5|fillcolor:0xFFFF0033|Haifa,+israel|Ashkelon,+israel|Jerusalem,+israel">
          <div class="price"></div>
        </div>
        <div class="category" data-type="workshop">
          <h2>
            סדנאת אלכוהול
          </h2>
          <img data-type="workshop" src="./workshop-big.jpg" height="350px">
          <span class="price"></span>
        </div>
        <div class="category" data-type="dj">
          <h2>
            דיג׳י
          </h2>
          <img data-type="dj" src="./dj-big.jpg" height="350px">
          <span class="price"></span>
        </div>
        <div class="category" data-type="photo">
          <h2>
            צלם
          </h2>
          <img data-type="photo" src="./yemima-big.jpg" height="350px">
          <span class="price"></span>
        </div>
        <div class="category" data-type="massage">
          <h2 class="type-name">
            מסאזי׳ם
          </h2>
          <img data-type="massage" src="./massage-big.jpg" height="350px">
          <span class="price"></span>
        </div>
        <div class="category" data-type="design">
          <h2 class="type-name">
            עיצוב
          </h2>
          <img data-type="design" src="./design-big.jpg" height="350px">
          <span class="price"></span>
        </div>
        <div class="category" data-type="sweets">
          <h2>
            מתוקים
          </h2>
          <img data-type="sweets" src="./sweets-big.jpg" height="350px">
          <span class="price"></span>
        </div>
        <div class="category" data-type="bar">
          <h2>
            בר
          </h2>
          <img data-type="bar" src="./bar-big.jpg" height="350px">
          <span class="price"></span>
        </div>
      </section>

      <style>
        .total-price {
          background-color: #E45954;
          color: #fff;
          text-align: center;
          font-size: 2rem;
          line-height: 5rem;
        }
      </style>
    </main>

    <footer class="fixed-to-center">
      <div class="total-price">
        <span>
          מחיר מוערך
        </span>
        <span class="price">
        </span>
      </div>
    </footer>
  </body>
</html>
